# 微信记录导出工具 GUI

这是一个带有图形用户界面的微信记录导出工具，基于 WeChatMsg 项目开发。该工具可以帮助您解密微信数据库、查看联系人信息，并导出聊天记录。

## 功能特点

1. **数据库解密**
   - 支持微信 3.x 和 4.0 版本
   - 自动检测并解密微信数据库

2. **联系人管理**
   - 查看所有联系人列表
   - 搜索联系人
   - 查看联系人详细信息

3. **记录导出**
   - 支持多种导出格式（HTML、TXT、DOCX、MARKDOWN、XLSX）
   - 可选择导出的消息类型
   - 可设置导出的时间范围

## 安装与使用

### 安装依赖

在使用本工具前，请确保已安装所有必要的依赖包：

```bash
pip install -r requirements.txt
```

或者使用 uv 安装：

```bash
uv pip install -r requirements.txt
```

如果遇到模块导入错误，可能需要单独安装以下依赖：

```bash
pip install pycryptodome pywin32 pillow lxml
```

### 运行程序

```bash
python run_wechat_export.py
```

或者使用 uv 运行：

```bash
uv run run_wechat_export.py
```

### 打包为可执行文件

本项目提供了打包脚本，可以将程序打包为可执行文件：

1. 使用批处理文件（推荐）：
   ```
   build_gui.bat
   ```
   按照提示选择打包模式。

2. 直接使用 Python 脚本：
   ```
   python build_exe.py --onedir
   ```

打包选项说明：
- `--onefile`：打包为单个可执行文件，但可能会遇到 DLL 加载问题
- `--onedir`：打包为文件夹，更可靠，推荐使用
- `--debug`：包含调试信息，生成的程序会显示控制台窗口
- `--collect-all`：收集所有必要的模块，解决模块导入错误，但会增加文件大小

如果打包后运行程序时遇到 DLL 加载错误，请尝试使用以下命令重新打包：
```
python build_exe.py --collect-all --debug --onedir
```

## 使用步骤

1. **解密数据库**
   - 选择您的微信版本（3.x 或 4.0）
   - 点击"开始解密"按钮
   - 等待解密完成

2. **查看联系人**
   - 解密完成后，程序会自动切换到联系人管理标签页
   - 点击"加载联系人"按钮加载联系人列表
   - 使用搜索框搜索特定联系人
   - 点击联系人查看详细信息

3. **导出记录**
   - 选择要导出的联系人
   - 设置输出目录
   - 选择导出格式
   - 设置时间范围和消息类型
   - 点击"开始导出"按钮
   - 等待导出完成

## 注意事项

- 请确保在运行程序前，微信已经处于登录状态
- 如果解密失败，请尝试重启微信后再试
- 导出大量消息可能需要较长时间，请耐心等待
- 本工具仅用于个人数据备份，请勿用于非法用途

## 常见问题

1. **解密失败**
   - 确保微信已登录
   - 重启微信后再试
   - 检查是否有足够的磁盘空间

2. **找不到联系人**
   - 确保数据库路径正确
   - 确保选择了正确的数据库版本
   - 尝试使用"测试连接"按钮检查数据库连接

3. **导出失败**
   - 检查输出目录是否有写入权限
   - 确保选择了正确的联系人

4. **打包后程序无法运行**
   - 如果遇到 `ImportError: DLL load failed while importing pyexpat` 错误，请使用 `--onedir` 模式重新打包
   - 如果遇到其他模块导入错误，请使用 `--collect-all` 参数重新打包
   - 确保已安装所有必要的依赖包

5. **加载联系人没有反应**
   - 检查日志区域是否有错误信息
   - 确保数据库文件存在且可读
   - 尝试使用"测试连接"按钮检查数据库连接

## 技术支持

如果您在使用过程中遇到问题，可以：
1. 查看日志区域的错误信息
2. 尝试使用调试模式运行程序（`python run_wechat_export.py`）
3. 参考 WeChatMsg 项目的文档和问题列表

## 许可证

本项目遵循与 WeChatMsg 项目相同的许可证。
